<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:YYYY-MM-DDThh="http://www.w3.org/1999/xhtml">
<head th:replace="fragment/config.html">
</head>
<body>
<div class="wrapper">
    <nav th:replace="fragment/sidebar.html">sidebar</nav>

    <div class="main">
        <nav th:replace="fragment/header.html">header</nav>

        <div class="col-md-4">
            <div class="container-fluid">
                <form class="d-flex" th:action = "|@{/search}|" th:method="get">
                    <select  name="searchType">
                        <option value="all">전체</option>
                        <option value="title">제목</option>
                        <option value="content">내용</option>
                        <option value="hashtag">해시태그</option>
                    </select>
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search" name="searchKey">
                    <input type="hidden" name="board-name" th:value="${boardName}"/>
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
            </div>
        </div>

        <main class="content">
            <div class="container-fluid p-0">
                <div class="row mb-2 mb-xl-3">
                    <div class="col-auto d-none d-sm-block">
                        <h1 class="h3 mb-3" th:text="|${boardName} 게시판|">게시판</h1>
                    </div>
                    <div th:if="${boardName != '전체'}" class="col-auto ms-auto text-end mt-n1">
                        <a class="btn btn-primary"  th:onclick="|location.href='@{/news/(board-name=${boardName})}'|">기사 가져오기</a>
                    </div>
                </div>
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <div class="container">
                        <div class="collapse navbar-collapse" id="navbarNav">
                            <ul class="navbar-nav">
                                <li class="nav-item">
                                    <a class="nav-link" th:onclick="|location.href='@{/(board-name=${boardName}, textType=GENERAL)}'|">일반글</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" th:onclick="|location.href='@{/(board-name=${boardName}, textType=ARTICLE)}'|">기사</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </nav>
                <div class="card">
                    <table class="table">
                        <thead>
                        <tr>
                            <th style="width:5%;">#</th>
                            <th style="width:10%;">분류</th>
                            <th style="width:10%;">게시판</th>
                            <th style="width:30%;">제목</th>
                            <th style="width:15%">작성자</th>
                            <th class="d-none d-md-table-cell" style="width:20%">작성일자</th>
                            <th>조회수</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="text, textStat: ${pageForm.textList}">
                            <td th:text="${textStat.index} + 1">순번</td>
                            <td th:text="${text.textType}">분류</td>
                            <td th:text="${text.getBoard().getName()}">게시판 이름</td>
                            <td th:text="${text.title}" th:onclick="|location.href='@{/show/{id}(id=${text.id})}'|">제목</td>
                            <td class="d-none d-md-table-cell" th:text="${text.customer.name}">작성자 이름</td>
                            <td><time datetime="YYYY-MM-DDThh:mm:ssTZD" th:text="${text.createdTime}"></time></td>
                            <td th:text="${text.viewCount}">조회수</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="text-center">
                    <ul th:if="${searchKey == ''}" class = "pagination pagination-md" style="list-style: none" >
                        <li class="page-item" style="display: inline">
                            <a th:if="${pageForm.isFirst == 'T'}" >prev</a>
                            <a th:if="${pageForm.isFirst == 'F'}" class="page-link" th:href="@{/(page=(${pageForm.page}-1))}" th:text="prev"></a>
                        </li>
                        <li class="page-item"  style="display: inline" th:each="pg : ${#numbers.sequence(pageForm.start, pageForm.start + pageForm.size - 1)}">
                            <a class="page-link" th:href = "@{/(page=(${pg}))}" th:text="(${pg} + 1) "></a>
                        </li>
                        <li class="page-item" style="display: inline">
                            <a th:if="${pageForm.isLast == 'T'}" >next</a>
                            <a th:if="${pageForm.isLast =='F'}" th:class="page-link" th:href="@{/(page=(${pageForm.page}+1))}" th:text="next"></a>
                        </li>
                    </ul>
                    <ul th:align="center" th:if="${searchKey != ''}" class = "pagination pagination-md" style="list-style: none">
                        <li class="page-item"  style="display: inline">
                            <a th:if="${pageForm.isFirst == 'T'}" >prev</a>
                            <a th:if="${pageForm.isFirst == 'F'}" class="page-link" th:href="@{/search/(page=(${pageForm.page}-1), searchKey = (${searchKey}), searchType = (${searchType}))}" th:text="prev"></a>
                        </li>
                        <li class="page-item"  style="display: inline" th:each="pg : ${#numbers.sequence(pageForm.start, pageForm.start + pageForm.size - 1)}">
                            <a class="page-link" th:href = "@{/search/(page=(${pg}), searchKey = (${searchKey}), type = (${type}))}" th:text="(${pg} + 1) "></a>
                        </li>
                        <li class="page-item"  style="display: inline">
                            <a th:if="${pageForm.isLast == 'T'}" >next</a>
                            <a th:if="${pageForm.isLast =='F'}" th:class="page-link" th:href="@{/search/(page=(${pageForm.page}+1), searchKey = (${searchKey}), searchType = (${searchType}))}" th:text="next"></a>
                        </li>
                    </ul>
                </div>
                <div class="text-center">
                    <button type="button" class="btn btn-secondary" th:onclick="|location.href='@{/}'|">홈</button>
                    <button type="button" class ="btn btn-primary" th:onclick="|location.href='/new'|">새로운 글 작성</button><br><br>
                </div>
            </div>
        </main>
    </div>
</div>
<script src="../../js/app.js"></script>

</body>
</html>